function G(j,k){return k.map((A)=>A/j*100)}class F{canvas;ctx;dropZone;previewLine;clearBtn;undoBtn;rulersList;imageInfo;currentImage=null;rulers=[];imageScale=1;imageOffsetX=0;imageOffsetY=0;displayedImageWidth=0;displayedImageHeight=0;constructor(){this.canvas=document.getElementById("imageCanvas"),this.ctx=this.canvas.getContext("2d"),this.dropZone=document.getElementById("dropZone"),this.previewLine=document.getElementById("previewLine"),this.clearBtn=document.getElementById("clearBtn"),this.undoBtn=document.getElementById("undoBtn"),this.rulersList=document.getElementById("rulersList"),this.imageInfo=document.getElementById("imageInfo"),this.initializeEventListeners()}initializeEventListeners(){this.dropZone.addEventListener("dragover",this.handleDragOver.bind(this)),this.dropZone.addEventListener("dragleave",this.handleDragLeave.bind(this)),this.dropZone.addEventListener("drop",this.handleDrop.bind(this)),document.addEventListener("paste",this.handlePaste.bind(this)),this.canvas.addEventListener("click",this.handleCanvasClick.bind(this)),this.canvas.addEventListener("mousemove",this.handleCanvasMouseMove.bind(this)),this.canvas.addEventListener("mouseleave",this.handleCanvasMouseLeave.bind(this)),this.clearBtn.addEventListener("click",this.clearRulers.bind(this)),this.undoBtn.addEventListener("click",this.undoLastRuler.bind(this)),document.addEventListener("keydown",this.handleKeyDown.bind(this)),window.addEventListener("resize",this.handleResize.bind(this))}handleDragOver(j){j.preventDefault(),this.dropZone.classList.add("drag-over")}handleDragLeave(j){j.preventDefault(),this.dropZone.classList.remove("drag-over")}handleDrop(j){j.preventDefault(),this.dropZone.classList.remove("drag-over");let k=j.dataTransfer?.files;if(k&&k.length>0)this.loadImageFile(k[0])}handlePaste(j){let k=j.clipboardData?.items;if(!k)return;for(let A of Array.from(k))if(A.type.startsWith("image/")){let q=A.getAsFile();if(q){this.loadImageFile(q);break}}}handleCanvasClick(j){if(!this.currentImage)return;let k=this.canvas.getBoundingClientRect(),A=j.clientX-k.left,B=(j.clientY-k.top-this.imageOffsetY)/this.imageScale;if(B>=0&&B<=this.currentImage.naturalHeight)this.addRuler(B)}handleCanvasMouseMove(j){if(!this.currentImage)return;let k=this.canvas.getBoundingClientRect(),A=j.clientY-k.top,q=(A-this.imageOffsetY)/this.imageScale;if(q>=0&&q<=this.currentImage.naturalHeight)this.previewLine.style.display="block",this.previewLine.style.top=`${A}px`;else this.previewLine.style.display="none"}handleCanvasMouseLeave(){this.previewLine.style.display="none"}handleKeyDown(j){if(j.key==="Escape")this.clearRulers();else if((j.ctrlKey||j.metaKey)&&j.key==="z")j.preventDefault(),this.undoLastRuler()}handleResize(){if(this.currentImage)this.drawImage()}loadImageFile(j){if(!j.type.startsWith("image/")){alert("Please select a valid image file.");return}let k=new FileReader;k.onload=(A)=>{let q=new Image;q.onload=()=>{this.currentImage=q,this.clearRulers(),this.drawImage(),this.updateImageInfo(),this.showCanvas()},q.src=A.target?.result},k.readAsDataURL(j)}showCanvas(){this.dropZone.style.display="none",this.canvas.style.display="block"}drawImage(){if(!this.currentImage)return;let k=this.canvas.parentElement.getBoundingClientRect().width-40,A=window.innerHeight-250,q=k/this.currentImage.naturalWidth,B=A/this.currentImage.naturalHeight,C=0.5,E=2;this.imageScale=Math.max(C,Math.min(q,B,E)),this.displayedImageWidth=this.currentImage.naturalWidth*this.imageScale,this.displayedImageHeight=this.currentImage.naturalHeight*this.imageScale,this.canvas.width=this.displayedImageWidth,this.canvas.height=this.displayedImageHeight,this.imageOffsetX=0,this.imageOffsetY=0,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(this.currentImage,0,0,this.displayedImageWidth,this.displayedImageHeight),this.drawRulers()}addRuler(j){if(j=Math.round(j),this.rulers.find((E)=>Math.abs(E.y-j)<3))return;let A=this.rulers.length>0?this.rulers[this.rulers.length-1].y:0,q=j-A,B=G(this.currentImage.naturalHeight,[q])[0],C={y:j,height:q,percentage:B};this.rulers.push(C),this.updateRulersList(),this.updateButtonStates(),this.drawRulers()}drawRulers(){if(!this.currentImage)return;this.canvas.parentElement.querySelectorAll(".ruler-line, .ruler-label").forEach((k)=>k.remove()),this.rulers.forEach((k,A)=>{let q=k.y*this.imageScale+this.imageOffsetY,B=document.createElement("div");B.className="ruler-line placed",B.style.top=`${q}px`,this.canvas.parentElement.appendChild(B);let C=document.createElement("div");C.className="ruler-label",C.style.top=`${q-15}px`,C.style.left=`${this.displayedImageWidth+10}px`,C.innerHTML=`y: <span class="ruler-y">${k.y}px</span> — h: <span class="ruler-height">${k.height}px</span> — <span class="ruler-percentage">${k.percentage.toFixed(3)}%</span>`,this.canvas.parentElement.appendChild(C)})}updateRulersList(){if(this.rulers.length===0){this.rulersList.innerHTML='<p class="no-rulers">No rulers placed yet</p>';return}let j="";this.rulers.forEach((k,A)=>{j+=`
        <div class="ruler-item">
          <div class="ruler-index">Ruler ${A+1}</div>
          <div class="ruler-details">
            y: <span class="ruler-y">${k.y}px</span><br>
            h: <span class="ruler-height">${k.height}px</span><br>
            %: <span class="ruler-percentage">${k.percentage.toFixed(3)}%</span>
          </div>
        </div>
      `}),this.rulersList.innerHTML=j}updateImageInfo(){if(!this.currentImage){this.imageInfo.innerHTML="<p>No image loaded</p>";return}this.imageInfo.innerHTML=`
      <div><span class="info-label">Original Size:</span><span class="info-value">${this.currentImage.naturalWidth} × ${this.currentImage.naturalHeight}px</span></div>
      <div><span class="info-label">Displayed Size:</span><span class="info-value">${Math.round(this.displayedImageWidth)} × ${Math.round(this.displayedImageHeight)}px</span></div>
      <div><span class="info-label">Scale Factor:</span><span class="info-value">${(this.imageScale*100).toFixed(1)}%</span></div>
      <div><span class="info-label">Rulers:</span><span class="info-value">${this.rulers.length}</span></div>
    `}updateButtonStates(){this.clearBtn.disabled=this.rulers.length===0,this.undoBtn.disabled=this.rulers.length===0,this.updateImageInfo()}clearRulers(){this.rulers=[],this.updateRulersList(),this.updateButtonStates(),this.drawRulers()}undoLastRuler(){if(this.rulers.length>0)this.rulers.pop(),this.updateRulersList(),this.updateButtonStates(),this.drawRulers()}}document.addEventListener("DOMContentLoaded",()=>{new F});

//# debugId=1D9BA75C7FAD232764756E2164756E21
//# sourceMappingURL=index.js.map
